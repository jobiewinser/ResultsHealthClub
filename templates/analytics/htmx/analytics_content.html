{%load static%}
<span id="analytics_span_wrapper">
    <button hidden id="refresh_base_analytics" hx-trigger="load, click delay:0.5s"
            hx-get="{%url 'get-base-analytics' %}"
            hx-include="#start_date, #end_date, #site_pk, #campaign_pk"
            hx-target="#base_analytics_span_wrapper"
            hx-indicator=".htmx-indicator-base-analytics"
            hx-swap="innerHTML"
            onclick="$('.htmx-indicator-base-analytics').addClass('htmx-request')">refresh</button>
    {%include 'analytics/htmx/base_analytics.html'%}    
    
    <div class="row my-3">
        <div class="col">
            <div class="card p-2">
                <div class="row">
                    <div class="col-md-auto">
                        <h5 data-bs-toggle="popover" 
                        data-bs-trigger="hover" 
                        data-bs-placement="top"
                        data-bs-html="true"
                        data-bs-content="This shows ...">Conversion Rate <i class="fa-solid fa-circle-info"></i></h5> 
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-auto">
                        <span class="secondary_td_layer">{{start_date}} - {{end_date}}</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col center">
                        <h1>{{conversion_rate|floatformat:2}}%</h1>
                    </div>
                </div>            
            </div> 
        </div>
                
        <div class="col-md-auto center">
            <img  class="htmx-indicator htmx-indicator-base-analytics" id="" src="https://htmx.org/img/bars.svg"/>
        </div>
        <div class="col">
            <div class="card p-2">
                <div class="row">
                    <div class="col-md-auto">
                        <h5 data-bs-toggle="popover" 
                        data-bs-trigger="hover" 
                        data-bs-placement="top"
                        data-bs-html="true"
                        data-bs-content="This shows ...">Current Call Count Distribution <i class="fa-solid fa-circle-info"></i></h5> 
                    </div>
                </div>
                
                <div class="row">
                    <div class="col">
                    </div>
                    <div class="col-md-auto" style="text-align:left">
                        {%for call_count_tuple in call_counts_tuples%}
                        <div class="row">
                            <div class="col-md-auto" style="text-align:left">
                                <small>Call {{call_count_tuple.0}} ({{call_count_tuple.1}}) - Â£{{call_count_tuple.2.campaign__product_cost__sum|floatformat:2}} ({{call_count_tuple.3|floatformat:2}}%)</small>
                            </div>
                        </div>
                        {%endfor%}
                    </div>
                    <div class="col">
                    </div>
                </div>
                
            </div>
        </div>
    </div> 
    <div class="row my-3">
        <div class="col">
            <div class="card p-2">
                <div class="row">
                    <div class="col-md-auto">
                        <h5 data-bs-toggle="popover" 
                        data-bs-trigger="hover" 
                        data-bs-placement="top"
                        data-bs-html="true"
                        data-bs-content="This shows the analytics for Leads and Sales for the chosen site (top left), between the times chosen (right).<br><br><small> (Jobie Note: Need to add gradient on percentage and time scale based table i.e 3 months shows individual weeks instead) </small>">Leads & Sales <i class="fa-solid fa-circle-info"></i></h5> 
                    </div>
                </div>

                <div class="col">
                    <button hidden id="refresh_lead_to_sales" hx-trigger="load, click delay:0.5s"
                        hx-get="{%url 'get-leads-to-sales' %}"
                        hx-include="#start_date, #end_date, #site_pk, #campaign_pk, #graph_type_leads_to_sale"
                        hx-target="#lead_to_sales_chart_wrapper"
                        hx-indicator="#htmx-indicator-leads-and-sales"
                        hx-swap="innerHTML"
                        onclick="$('#htmx-indicator-leads-and-sales').addClass('htmx-request')">refresh</button>
                    {%include 'analytics/htmx/leads_to_sale.html'%}
                </div>
            </div>
        </div>
    </div> 
    <div class="row my-3">
        <div class="col">
            <div class="card p-2">
                <div class="row">
                    <div class="col-md-auto">
                        <h5 data-bs-toggle="popover" 
                        data-bs-trigger="hover" 
                        data-bs-placement="top"
                        data-bs-html="true"
                        data-bs-content="This shows the analytics for Leads and Bookings for the chosen site (top left), between the times chosen (right).<br><br><small> (Jobie Note: Need to add gradient on percentage and time scale based table i.e 3 months shows individual weeks instead) </small>">Leads & Bookings <i class="fa-solid fa-circle-info"></i></h5> 
                    </div>
                </div>

                <div class="col">
                    <button hidden id="refresh_lead_to_bookings" hx-trigger="load, click delay:0.5s"
                        hx-get="{%url 'get-leads-to-bookings' %}"
                        hx-include="#start_date, #end_date, #site_pk, #campaign_pk, #graph_type_leads_to_booking"
                        hx-target="#lead_to_bookings_chart_wrapper"
                        hx-indicator="#htmx-indicator-leads-and-bookings"
                        hx-swap="innerHTML"
                        onclick="$('#htmx-indicator-leads-and-bookings').addClass('htmx-request')">refresh</button>
                    {%include 'analytics/htmx/leads_to_booking.html'%}
                </div>
            </div>
        </div>
    </div> 
</span>