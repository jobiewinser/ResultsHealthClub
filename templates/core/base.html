{%load static core_tags%}
<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<html>
    <head>
        {%block cdn%}
            <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" />

            <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>                    
            <script src="{% static 'js/jquery-3.6.0.js' %}"></script>                    
            <script src="{% static 'js/popper.min.js' %}"></script>                    
            <script src="{% static 'js/fontawesome.js' %}"></script>  
            <script src="{% static 'js/htmx.min.js' %}"></script>  
            <script src="{% static 'js/palette.js' %}"></script>        
            <link href="{% static 'css/snackbar.css' %}" rel="stylesheet" />
            <script src="{% static 'js/snackbar.js' %}"></script> 
            
            <link rel="stylesheet" type="text/css"  href="{% static 'css/side_bar.css' %}">
            <link rel="stylesheet" type="text/css"  href="{% static 'css/base.css' %}">
           {%endblock cdn%}

        {%block scripts%}
        <script>
            function fallbackCopyTextToClipboard(text) {
                var textArea = document.createElement("textarea");
                textArea.value = text;
                
                // Avoid scrolling to bottom
                textArea.style.top = "0";
                textArea.style.left = "0";
                textArea.style.position = "fixed";
              
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
              
                try {
                  var successful = document.execCommand('copy');
                  var msg = successful ? 'successful' : 'unsuccessful';
                  if (msg == 'successful') {
                    snackbarShow('Successfully copied free taster link', 'success')
                  } else {
                    snackbarShow('Failed to copy free taster link', 'danger')
                  }
                } catch (err) {
                }
              
                document.body.removeChild(textArea);
              }

              function inlinePreventDefault(e) {
                  e.preventDefault();
              }
              
              function copyTextToClipboard(text) {
                if (!navigator.clipboard) {
                  fallbackCopyTextToClipboard(text);
                  return;
                }
                navigator.clipboard.writeText(text).then(function() {
                    snackbarShow('Successfully copied free taster link', 'success')
                }, function(err) {
                    snackbarShow('Failed to copy free taster link', 'danger')
                });
              }
            </script>
            
            <script>
                let dt = null;
                $(document).ready(function() {
                    $("[data-bs-toggle=popover]").popover();
                    document.body.addEventListener('htmx:afterSwap', function(evt) {  
                        if (evt.detail.target.id == 'generic_modal_body'){
                            $('#generic_modal').modal('show');
                        }                        
                        if (evt.detail.xhr.status == 200){
                        } else {
                            snackbarShow(evt.detail.xhr.responseText, 'danger')
                        }
                        $('.popover').remove()
                        $('[data-bs-toggle=popover]').popover();
                    });                    
                    document.body.addEventListener('htmx:configRequest', function(evt) {    
                        evt.detail.headers['x-csrftoken'] = $('#csrf_token').val();
                    });
                });
            </script>
        {%endblock scripts%}

        {%block styles%}
        <style>
              
        </style>
        {%endblock styles%}
        
    </head>

    <body>
        <!-- Sidebar-->
        <div class="row">
            <nav class="col-md-auto p-0 side_nav bg-dark hide_small">
                {%block navbar%}
                    <a class="navbar-brand" href="{%url 'home'%}"><img class="crop-squarelogo" src="{% static 'img/logo_white.png' %}" alt="winser systems logo"></a>
                    
                    <hr class="text-white m-1 side_nav_hr">
                    <ul class="nav nav-pills">
                        <li class="mb-1">
                            <button class="side_nav_button btn btn-toggle align-items-center rounded collapsed {%if 'products' in request.path%} active{%endif%}"
                                data-bs-toggle="collapse" data-bs-target="#home-collapse" 
                                {%if 'products' in request.path%} aria-expanded="true"{%endif%}>
                            Products
                            </button>
                            <div class="collapse {%if 'products' in request.path%} active show{%endif%}" id="home-collapse">
                                <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                                    <li><a href="{% url 'campaign-leads-product-page'%}" class="link-light rounded {%if 'campaign-leads-product-page' in request.path%}active{%endif%}">Campaign Leads System</a></li>
                                </ul>
                            </div>
                        </li>              
                    </ul>     
                    <ul class="nav nav-pills ">
                        <li class="m-1">
                            <div class="dropdown  m-2" id="profile-nav-section">
                                {%include 'core/htmx/profile-nav-section.html'%}
                            </div> 
                        </li>                   
                    </ul>   
                {%endblock navbar%}
            </nav>
            <nav class="col p-0 side_nav bg-dark show_small">
                <div class="row">
                    <div class="col-md-auto p-0">
                        <a class="show_small" href="{%url 'home'%}"><img class="crop-squarelogo-small" src="{% static 'img/logo_white.png' %}" alt="winser systems logo"></a>  
                    </div>
                    <div class="col p-0">
                    </div>
                    <div class="col-md-auto p-0">
                        <ul class="nav nav-pills ">
                            <li class="m-1">
                                <div class="dropdown  m-2" id="profile-nav-section">
                                    {%include 'core/htmx/profile-nav-section.html'%}
                                </div> 
                            </li>                   
                        </ul>   
                    </div>
                </div>
            </nav>
            <!-- Page content wrapper-->
            <div class="col p-0">
                {%block content%}
                {%endblock content%}
            </div>
        </div>

        <div class="modal fade" id="generic_modal" role="dialog" style="overflow:hidden;display: none;">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="generic_modal_title"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true"></span>
                        </button>
                    </div> 
                    <div class="modal-body" id="generic_modal_body">
                    </div>
                </div>
            </div>
        </div>
        
    </body>
    <div id="snackbar"></div>
</html>

