{%load static%}
<!DOCTYPE html>
<html>
    <head>
        {%block cdn%}
            <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" />

            <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>                    
            <script src="{% static 'js/jquery-3.6.0.js' %}"></script>                    
            <script src="{% static 'js/popper.min.js' %}"></script>                    
            <script src="{% static 'js/fontawesome.js' %}"></script>  
            <script src="{% static 'js/htmx.min.js' %}"></script>  
            <script src="{% static 'js/palette.js' %}"></script>        
            <link href="{% static 'css/snackbar.css' %}" rel="stylesheet" />
            <script src="{% static 'js/snackbar.js' %}"></script> 
            <link href="{% static 'css/datatables.css' %}" rel="stylesheet" />
            <script src="{% static 'js/datatables.js' %}"></script> 
            
            <link rel="stylesheet" type="text/css"  href="{% static 'css/base.css' %}">
           {%endblock cdn%}

        {%block scripts%}
        <script>
            function fallbackCopyTextToClipboard(text) {
                var textArea = document.createElement("textarea");
                textArea.value = text;
                
                // Avoid scrolling to bottom
                textArea.style.top = "0";
                textArea.style.left = "0";
                textArea.style.position = "fixed";
              
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
              
                try {
                  var successful = document.execCommand('copy');
                  var msg = successful ? 'successful' : 'unsuccessful';
                  if (msg == 'successful') {
                    snackbarShow('Successfully copied free taster link', 'success')
                  } else {
                    snackbarShow('Failed to copy free taster link', 'danger')
                  }
                } catch (err) {
                }
              
                document.body.removeChild(textArea);
              }

              function inlinePreventDefault(e) {
                  e.preventDefault();
              }
              
              function copyTextToClipboard(text) {
                if (!navigator.clipboard) {
                  fallbackCopyTextToClipboard(text);
                  return;
                }
                navigator.clipboard.writeText(text).then(function() {
                    snackbarShow('Successfully copied free taster link', 'success')
                }, function(err) {
                    snackbarShow('Failed to copy free taster link', 'danger')
                });
              }
            </script>
            
            <script>
                let dt = null;
                $(document).ready(function() {
                    $("[data-bs-toggle=popover]").popover();
                    document.body.addEventListener('htmx:afterSwap', function(evt) {  
                        if (evt.detail.target.id == 'generic_modal_body'){
                            $('#generic_modal').modal('show');
                        }
                        if (evt.detail.pathInfo.path.includes("switch-user")){
                            $('#generic_modal').modal('hide');
                            snackbarShow('Successfully switched user', 'success')
                        }

                        if (evt.detail.xhr.status == 200){
                        } else {
                            snackbarShow(evt.detail.xhr.responseText, 'danger')
                        }
                        $('.popover').remove()
                        $('[data-bs-toggle=popover]').popover();
                    });
                    
                    document.body.addEventListener('htmx:configRequest', function(evt) {    
                        evt.detail.headers['x-csrftoken'] = $('#csrf_token').val();
                    });
                });
            </script>
        {%endblock scripts%}

        {%block styles%}
        <style>
            .row {
                width:100%;
                margin:0px;
            }
            .no-bullet {
                list-style-type: none; 
            }
            .modal {
            text-align: center;
            padding: 0!important;
            }
            .modal:before {
            content: '';
            display: inline-block;
            height: 100%;
            vertical-align: middle;
            margin-right: -4px;
            }
            .modal-dialog {
            display: inline-block;
            text-align: left;
            vertical-align: middle;
            }
            .nowrap {
                white-space: nowrap;
            }
            .badge > * {
                vertical-align:middle;
            }
            .user-select {
                text-align:center;
                cursor: pointer;
            }
            .current-user-highlight {
                background-color: rgba(25, 135, 84, 0.3) !important;
                border: rgba(25, 135, 84, 0.8) !important;
            }
            .content {
                margin-top:10px;
            }
            #booking-type:checked ~ #booking-type-span-one {
                color:green
            }
            .badge {
                text-shadow: none;
                font-size: .9em;
                font-weight: 400;
            }
              
        </style>
        {%endblock styles%}
        
    </head>

    <body>

        {%block navbar%}
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container-fluid">
                        <a href="#" class="navbar-brand p-0"><img src="{% static 'img/logo_white.png' %}" height="40px" style="object-fit: cover;"></a>
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                                <li class="nav-item">
                                <a class="nav-link{%if request.path == '/' or request.path == '/academy-leads-overview/'%} active{%endif%}" href="{% url 'academy-leads-overview' %}">Academy Leads</a>
                                </li>
                                <li class="nav-item">
                                <a class="nav-link{%if request.path == '/academy-booking-overview/'%} active{%endif%}" href="{% url 'academy-booking-overview' %}">Academy Bookings</a>
                                </li>
                                <li class="nav-item">
                                <a class="nav-link{%if request.path == '/free-taster/'%} active{%endif%}" href="{% url 'free-taster' %}">Free Taster Links</a>
                                </li>   
                                <li class="nav-item">
                                <a class="nav-link{%if request.path == '/analytics/'%} active{%endif%}" href="{% url 'analytics' %}">Analytics (BETA)</a>
                                </li>                                
                            </ul>
                            <ul class="navbar-nav me-auto">
                                <li class="nav-item">                                    
                                    <a class="nav-link" href="#"><img  class="htmx-indicator top-htmx-indicator" src="https://htmx.org/img/bars.svg"/></a>
                                </li>                          
                                
  
                            </ul>
                            <ul class="navbar-nav me-3 m-0" style="text-align:right">
                                <li class="nav-item">
                                <a class="nav-link{%if 'configuration' in request.path %} active{%endif%}" href="{% url 'configuration' %}"><i class="fa-light fa-gear"></i> Configuration</a>
                                </li>                               
                            </ul>
                            {%include 'core/htmx/profile_dropdown.html'%}
                        </div>
                </div>
            </nav>
        {%endblock navbar%}
        
        <div class="content">
            {%block content%}
            {%endblock content%}
        </div>

        <div class="modal fade" id="generic_modal" role="dialog" style="overflow:hidden;display: none;">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="generic_modal_title"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true"></span>
                        </button>
                    </div> 
                    <div class="modal-body" id="generic_modal_body">
                    </div>
                </div>
            </div>
        </div>
        
    </body>
    <div id="snackbar"></div>
</html>

