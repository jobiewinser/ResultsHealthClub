<div class="generic_modal_contents">
    <div class="row">
        <div class="col center">
            
            <div class="btn-group btn-space">
                <button class="btn btn-success btn-sm" type="button"
                    data-bs-toggle="popover" 
                    data-bs-trigger="hover" 
                    data-bs-placement="top"
                    data-bs-content="See call history for this lead."
                    hx-indicator=".top-htmx-indicator" hx-target="#generic_modal_body" 
                    hx-vals='{"template_name": "call_history"}'
                    hx-get="{% url 'campaign-lead-get-modal-content' param1=lead.pk %}" 
                    hx-push-url="false"
                    hx-swap="innerHTML" hx-trigger="click">
                        Call History 
                        <span class="badge bg-info" style="font-size:10px">
                            {{lead.call_set.all.count}}                
                        </span>
                </button>
                <button class="btn btn-sm btn-secondary"
                    data-bs-toggle="popover" 
                    data-bs-trigger="hover" 
                    data-bs-placement="top"
                    data-bs-content="See booking history for this lead."
                    hx-indicator=".top-htmx-indicator" hx-target="#generic_modal_body" 
                    hx-vals='{"template_name": "booking_history"}'
                    hx-get="{% url 'campaign-lead-get-modal-content' param1=lead.pk %}" 
                    hx-push-url="false"
                    hx-swap="innerHTML" hx-trigger="click">
                        Booking History
                        <span class="badge bg-info" style="font-size:10px">
                            {{lead.ordered_bookings.count}}                
                        </span>
                </button>     
                <button class="btn btn-sm btn-secondary"
                    data-bs-toggle="popover" 
                    data-bs-trigger="hover" 
                    data-bs-placement="top"
                    data-bs-content="See note history for this lead."
                    hx-indicator=".top-htmx-indicator" hx-target="#generic_modal_body" 
                    hx-vals='{"template_name": "note_history"}'
                    hx-get="{% url 'campaign-lead-get-modal-content' param1=lead.pk %}" 
                    hx-push-url="false"
                    hx-swap="innerHTML" hx-trigger="click">
                        Note History
                        <span class="badge bg-info" style="font-size:10px">
                            {{lead.note_set.all.count}}                
                        </span>
                </button> 
            </div> 
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <table class="table" id="">
                <thead>
                  <tr>
                    <th ><strong>History</strong></th>
                    <th style="width:400px">
                  </tr>
                </thead>
                <tbody class="noteBody">
                    {%for call in lead.call_set.all%}
                    <tr>
                        <td colspan="2"
                        data-bs-html="true" 
                        data-bs-toggle="popover" 
                        data-bs-trigger="hover" 
                        data-bs-placement="right"
                        data-bs-content="
                        <b>Call</b>
                        {%if call.note_set.all%}
                        <br>
                        <b>Notes:</b>
                        <ul>
                            {%for note in call.note_set.all%}
                            <li>{{note.text}} - <i>{{note.user}}, {{note.datetime}}</i></li>
                            {%endfor%}
                        </ul>
                        {%endif%}
                        {%if call.whatsappmessage.whatsappmessagestatus_set.all%}
                        <br>
                        <b>Message Status:</b>
                        <ul>
                            {%for status in call.whatsappmessage.whatsappmessagestatus_set.all%}
                            <li><b>{{status.status}}</b> {{status.datetime}} </li>
                            {%endfor%}
                        </ul>
                        {%endif%}
                        " class="double_layer_td">                                
                            <div class="row">   
                                <div class="col p-0">                     
                                    <span class="primary_td_layer">
                                        <i  class="fa fa-{%if call.type == 'a'%}phone{%elif call.type == 'b'%}whatsapp{%elif call.type == 'c'%}envelope{%elif call.type == 'd'%}message-sms{%endif%}" 
                                            style="color:grey" 
                                            aria-hidden="true"></i>  
                                            - 
                                            {{call.datetime}}</span>
                                    <br>
                                    <span class="secondary_td_layer">{{call.user.first_name}} {{call.user.last_name}}</span>    
                                </div>
                                <div class="col-md-auto  p-0">
                                    {%if call.note_set.all%}
                                        <i class="fa-duotone fa-note"></i>
                                    {%endif%}
                                </div>
                            </div>
                        </td>
                    </tr>
                    {%endfor%}
                </tbody>
              </table>
        </div>
    </div>
</div>
<span hx-swap-oob="true" id="generic_modal_title">
    Call History - {{lead.name}}
    <input type="text" style="display:None" id="modal_lead_pk" name="lead_pk" value="{{lead.pk}}"/>
</span>