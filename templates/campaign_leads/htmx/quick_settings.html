{%load static tz core_tags user_permission_tags%}

<span id="payment_methods_wrapper">
    <script>
        $('#generic_modal').on('hidden.bs.modal', function (e) {
            $('#page_load_indicator').addClass('htmx-request')
            window.location.reload();
        })
    </script>
    <div class="card card-highlight">
        <div class="card-body">
            <div class="alert alert-warning p-2">
                Below are some quick integrations you can add. <br>You can also change them from the Site Configuration page.              
            </div>
            <div class="container">
                <div class="row">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" id="slide-toggle" onclick="$('#calendly_quick_settings').slideToggle('fast');"/> <i class="fa-regular fa-calendar-days"></i> Calendly
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12" style="min-width:1050px">
                    <div class="panel panel-default" style="display:none;" id="calendly_quick_settings">
                      <div class="panel-body">
                        {%include 'core/htmx/calendly_site_settings.html'%}
                      </div>
                    </div>
                  </div>
                </div>
            </div>
            <hr>
            <div class="container">
                <div class="row">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" id="slide-toggle" onclick="$('#active_campaign_quick_settings').slideToggle('fast');"/> <i class="fa-light fa-dumbbell"></i> Active Campaign
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12">
                    <div class="panel panel-default" style="display:none;" id="active_campaign_quick_settings">
                      <div class="panel-body">
                        Active Campaign Settings
                      </div>
                    </div>
                  </div>
                </div>
            </div>
            <hr>
            <div class="container">
                <div class="row">
                  <div class="col-sm-12">
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" id="slide-toggle" onclick="$('#whatsapp_quick_settings').slideToggle('fast');"/> <i class="fa fa-whatsapp"></i> Whatsapp <i class="fa-solid fa-rectangle-pro"></i>
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12">
                    <div class="panel panel-default" style="display:none;" id="whatsapp_quick_settings">
                      <div class="panel-body">
                        {%if site.subscription.whatsapp_enabled %} 
                        Whatsapp Settings
                        {%else%}
                        <div class="alert alert-info">
                          <p>With a <i class="fa-solid fa-rectangle-pro"></i> subscription, you can automate further by automatically sending <i class="fa fa-whatsapp text-success" aria-hidden="true"></i> Whatsapp templates to your customers immediately after they fill in your Active Campaign Forms.</p>
                          <p>You can also manage multiple whatsapp phone numbers from one screen, here on Winser Systems.</p>
                          {%for subscription_option in subscription_options%}
                          {%if not subscription_option == site.subscription and subscription_option.whatsapp_enabled%}
                              <button class="btn btn-sm btn-{{subscription_option.bootstrap_colour}}"
                                  hx-indicator=".top-htmx-indicator" hx-target="#generic_modal_body" 
                                  hx-vals='{"template_name": "switch_subscription","switch_subscription":"{{subscription_option.numerical}}","site_pk":"{{site.pk}}"}'
                                  hx-get="{% url 'campaign-lead-get-modal-content'%}" 
                                  hx-push-url="false"
                                  hx-swap="innerHTML" hx-trigger="click">
                                  Switch to <b>{{subscription_option.get_name_display}}</b> subscription Â£{{subscription_option.cost|floatformat:2}} p/m (for this site)
                              </button>
                          {%endif%}
                          {%endfor%}
                        </div>
                        {%endif%}
                      </div>
                    </div>
                  </div>
                </div>
            </div>            
        </div>                
    </div>
</span>
<span hx-swap-oob="true" id="generic_modal_title">
    Quick Settings for {{site.name}}
</span>