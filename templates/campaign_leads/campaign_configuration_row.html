
{%load static tz core_tags%}
<td>
    {{campaign.name}}
</td>
<td
data-bs-toggle="popover" 
data-bs-trigger="hover" 
data-bs-html="true" 
data-bs-placement="top"
data-bs-title="What does this do?"
data-bs-content="
<p>
    You can assign your lead campaign to any site under your company here. The templates available to auto send will depend on which site the lead campaign belongs to.
</p>
{%if campaign.is_manual%}
<p>
    This is disabled as it was automatically created by Winser Systems for manually created leads.
</p>
{%endif%}
"> 
    {%include 'campaign_leads/htmx/campaign_configuration_select.html'%}
<button hidden 
hx-post="{% url 'set-campaign-site' campaign_pk=campaign.pk %}" 
hx-swap="outerHTML" hx-include="#site_pk_{{campaign.pk}}" 
id="submit_site_pk_{{campaign.pk}}"></button>
</td>
<td>                                 
    <select class="form-select" name="first_template_pk" id="first_template_{{campaign.pk}}" onchange="$('#assign_first_template_{{campaign.pk}}').click();"    
        data-bs-toggle="popover" 
        data-bs-trigger="hover" 
        data-bs-html="true" 
        data-bs-placement="top"
        data-bs-title="What does this do?"
        data-bs-content='
        <p>
            You can assign your lead campaign a template to send through your chosen messaging service automatically (Whatsapp by default).
        </p>
        <p>
            For example, when Winser Systems is notified by your lead campaign about a new lead, they will receive the "1st Auto-Send Template" you have chosen.
        </p>
        '>
        <option value=""></option>
        {%for template in campaign.get_site_templates%}
        {%if not 'sample_' in template.name%}
        <option {%if campaign.first_send_template.pk == template.pk %}selected{%endif%} value="{{template.pk}}">{{template.name}}</option>
        {%endif%}
        {%endfor%}
    </select>
    <button hidden hx-post="{% url 'whatsapp-assign-auto-send-template' %}" hx-swap="innerHTML" 
        hx-include="#first_template_{{campaign.pk}}" hx-indicator=".top-htmx-indicator" 
        hx-vals='{"campaign_pk": "{{campaign.pk}}"}'
        hx-target="#row_{{campaign.pk}}" id="assign_first_template_{{campaign.pk}}" 
        class="btn btn-primary btn-sm">assign</button>
</td>
<td>                             
    <select class="form-select" name="second_template_pk" id="second_template_{{campaign.pk}}" onchange="$('#assign_second_template_{{campaign.pk}}').click();"    
        data-bs-toggle="popover" 
        data-bs-trigger="hover" 
        data-bs-html="true" 
        data-bs-placement="top"
        data-bs-title="What does this do?"
        data-bs-content='
        <p>
            You can assign your lead campaign a template to send through your chosen messaging service automatically (Whatsapp by default).
        </p>
        <p>
            For example, if the lead has not responded to the first notification, they will receive the "2nd Auto-Send Template" 24 hours after the first.
        </p>
        '>
        <option value=""></option>
        {%for template in campaign.get_site_templates%}
        {%if not 'sample_' in template.name%}
        <option {%if campaign.second_send_template.pk == template.pk %}selected{%endif%} value="{{template.pk}}">{{template.name}}</option>
        {%endif%}
        {%endfor%}
    </select>            
    <button hidden hx-post="{% url 'whatsapp-assign-auto-send-template' %}" hx-swap="innerHTML" 
        hx-include="#second_template_{{campaign.pk}}" hx-indicator=".top-htmx-indicator" 
        hx-vals='{"campaign_pk": "{{campaign.pk}}"}'
        hx-target="#row_{{campaign.pk}}" id="assign_second_template_{{campaign.pk}}" 
        class="btn btn-primary btn-sm">assign</button>             
</td>
<td>                           
    <select class="form-select" name="third_template_pk" id="third_template_{{campaign.pk}}" onchange="$('#assign_third_template_{{campaign.pk}}').click();"    
        data-bs-toggle="popover" 
        data-bs-trigger="hover" 
        data-bs-html="true" 
        data-bs-placement="top"
        data-bs-title="What does this do?"
        data-bs-content='
        <p>
            You can assign your lead campaign a template to send through your chosen messaging service automatically (Whatsapp by default).
        </p>
        <p>
            For example, if the lead has not responded to the first notification, they will receive the "3rd Auto-Send Template" 24 hours after the second.
        </p>
        '>
        <option value=""></option>
        {%for template in campaign.get_site_templates%}
        {%if not 'sample_' in template.name%}
        <option {%if campaign.third_send_template.pk == template.pk %}selected{%endif%} value="{{template.pk}}">{{template.name}}</option>
        {%endif%}
        {%endfor%}
    </select>           
    <button hidden hx-post="{% url 'whatsapp-assign-auto-send-template' %}" hx-swap="innerHTML" 
        hx-include="#third_template_{{campaign.pk}}" hx-indicator=".top-htmx-indicator" 
        hx-vals='{"campaign_pk": "{{campaign.pk}}"}'
        hx-target="#row_{{campaign.pk}}" id="assign_third_template_{{campaign.pk}}" 
        class="btn btn-primary btn-sm">assign</button>                
</td>